---
// src/components/Pendidikan/PendidikanContainer.astro
import Header from './Header.astro';
import Nav from './Nav.astro';
import './pendidikan.css';
// Import CSS Global Slideshow
import '../../Global/Slideshow/slideshow.css';
import { educationData } from './educationData.js';
---

<div class="pendidikan-wrapper">
    <div class="card-container">
        
        <Header />
        <Nav />

        <main id="main-content-area" style="min-height: 200px;">
            {Object.entries(educationData).map(([key, level]) => (
                <section id={key} class="program-section">
                    <h2 class="level-title">{level.title}</h2>
                    
                    {level.schools.map((school, index) => (
                        <div class="school-block">
                            <h3 class="school-title">{school.name}</h3>
                             
                            <div 
                                id={`slideshow-${key}-${index}`} 
                                class="slideshow-wrapper"
                                data-images={JSON.stringify(school.images)}
                            ></div>

                            <div class="school-actions">
                                {school.locationLink && (
                                    <a href={school.locationLink} class="action-btn" target="_blank">
                                        <img src="/Imagery/an_area.webp" alt="Lokasi" />
                                        <span>Lihat Lokasi</span>
                                    </a>
                                )}
                                {school.facebookLink && (
                                    <a href={school.facebookLink} class="action-btn btn-fb" target="_blank">
                                        <img src="/Imagery/Facebook_logo.webp" alt="Facebook" />
                                        <span>Facebook</span>
                                    </a>
                                )}
                            </div>
                        </div>
                    ))}
                </section>
            ))}
        </main>
    
    </div>
</div>

<script>
  import { GlobalSlideshow } from '../../Global/Slideshow/GlobalSlideshow.js';

  // --- INISIALISASI ---
  let instances = [];

  function initSlideshows() {
      const wrappers = document.querySelectorAll('.slideshow-wrapper');
      wrappers.forEach(wrapper => {
          const imagesAttr = wrapper.getAttribute('data-images');
          if (imagesAttr) {
              try {
                  const images = JSON.parse(imagesAttr);
                  // Inisialisasi Global Slideshow
                  const instance = new GlobalSlideshow(wrapper, images);
                  instances.push(instance);
              } catch (e) {
                  console.error("Gagal parse gambar slideshow", e);
              }
          }
      });
  }

  // --- NAVIGATION SCROLL ---
  // @ts-ignore
  window.scrollToSection = function(id) {
      const element = document.getElementById(id);
      if (element) {
          const offset = 20;
          const bodyRect = document.body.getBoundingClientRect().top;
          const elementRect = element.getBoundingClientRect().top;
          const elementPosition = elementRect - bodyRect;
          const offsetPosition = elementPosition - offset;
          window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
      }
  };

  // Run on load
  initSlideshows();
</script>